const res = {
  results: {
    results: [
      [
        { dtime: "2019-12-18", val: 3 },
        { dtime: "2019-12-19", val: 1 },
        { dtime: "2019-12-20", val: 7 },
        { dtime: "2019-12-21", val: 8 },
        { dtime: "2019-12-22", val: 13 },
        { dtime: "2019-12-23", val: 5 },
        { dtime: "2019-12-24", val: 12 },
        { dtime: "2019-12-25", val: 2 },
        { dtime: "2019-12-26", val: 1 },
        { dtime: "2019-12-27", val: 3 },
        { dtime: "2019-12-28", val: 6 },
        { dtime: "2019-12-29", val: 7 },
        { dtime: "2019-12-30", val: 1 },
        { dtime: "2019-12-31", val: 3 },
        { dtime: "2020-01-01", val: 6 },
        { dtime: "2020-01-02", val: 7 },
        { dtime: "2020-01-03", val: 3 },
        { dtime: "2020-01-04", val: 1 },
        { dtime: "2020-01-05", val: -2 },
        { dtime: "2020-01-06", val: 3 },
        { dtime: "2020-01-07", val: 6 },
        { dtime: "2020-01-08", val: 7 },
        { dtime: "2020-01-09", val: 9 },
        { dtime: "2020-01-10", val: 4 },
        { dtime: "2020-01-11", val: 5 },
        { dtime: "2020-01-12", val: 9 },
        { dtime: "2020-01-13", val: 7 },
        { dtime: "2020-01-14", val: 2 },
        { dtime: "2020-01-15", val: 3 }
      ],
      [
        { dtime: "2019-12-18", val: 2 },
        { dtime: "2019-12-19", val: 3 },
        { dtime: "2019-12-20", val: 4 },
        { dtime: "2019-12-21", val: 1 },
        { dtime: "2019-12-22", val: 3 },
        { dtime: "2019-12-23", val: 4 },
        { dtime: "2019-12-24", val: 5 },
        { dtime: "2019-12-25", val: 24 },
        { dtime: "2019-12-26", val: 1 },
        { dtime: "2019-12-27", val: 3 },
        { dtime: "2019-12-28", val: 1 },
        { dtime: "2019-12-29", val: 4 },
        { dtime: "2019-12-30", val: 3 },
        { dtime: "2019-12-31", val: 3 },
        { dtime: "2020-01-01", val: 6 },
        { dtime: "2020-01-02", val: 7 },
        { dtime: "2020-01-03", val: 8 },
        { dtime: "2020-01-04", val: 3 },
        { dtime: "2020-01-05", val: 1 },
        { dtime: "2020-01-06", val: 3 },
        { dtime: "2020-01-07", val: 8 },
        { dtime: "2020-01-08", val: 6 },
        { dtime: "2020-01-09", val: 5 },
        { dtime: "2020-01-10", val: 4 },
        { dtime: "2020-01-11", val: 3 },
        { dtime: "2020-01-12", val: 7 },
        { dtime: "2020-01-13", val: 3 },
        { dtime: "2020-01-14", val: 2 },
        { dtime: "2020-01-15", val: 6 }
      ],
      [
        { dtime: "2019-12-18", val: 2 },
        { dtime: "2019-12-19", val: 7 },
        { dtime: "2019-12-20", val: 3 },
        { dtime: "2019-12-21", val: 4 },
        { dtime: "2019-12-22", val: 7 },
        { dtime: "2019-12-23", val: 4 },
        { dtime: "2019-12-24", val: 2 },
        { dtime: "2019-12-25", val: 7 },
        { dtime: "2019-12-26", val: 9 },
        { dtime: "2019-12-27", val: 6 },
        { dtime: "2019-12-28", val: 3 },
        { dtime: "2019-12-29", val: 2 },
        { dtime: "2019-12-30", val: 7 },
        { dtime: "2019-12-31", val: 9 },
        { dtime: "2020-01-01", val: 3 },
        { dtime: "2020-01-02", val: 3 },
        { dtime: "2020-01-03", val: 7 },
        { dtime: "2020-01-04", val: 9 },
        { dtime: "2020-01-05", val: 3 },
        { dtime: "2020-01-06", val: 2 },
        { dtime: "2020-01-07", val: 6 },
        { dtime: "2020-01-08", val: 8 },
        { dtime: "2020-01-09", val: 3 },
        { dtime: "2020-01-10", val: 2 },
        { dtime: "2020-01-11", val: 9 },
        { dtime: "2020-01-12", val: 8 },
        { dtime: "2020-01-13", val: 5 },
        { dtime: "2020-01-14", val: 10 },
        { dtime: "2020-01-15", val: 0 }
      ]
    ],
    legend: ["温度最大极差", "电压最大极差", "SOC最大极差"],
    unit: ["°C", "V", "%"],
    timeInterval: [1, 1, 1]
  },
  table: [
    { num: 1, dtime: "2019-12-18", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 2, dtime: "2019-12-19", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 3, dtime: "2019-12-20", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 4, dtime: "2019-12-21", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 5, dtime: "2019-12-22", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 6, dtime: "2019-12-23", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 7, dtime: "2019-12-24", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 8, dtime: "2019-12-25", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 9, dtime: "2019-12-26", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 10, dtime: "2019-12-27", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 11, dtime: "2019-12-28", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 12, dtime: "2019-12-29", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 13, dtime: "2019-12-30", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 14, dtime: "2019-12-31", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 15, dtime: "2020-01-01", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 16, dtime: "2020-01-02", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 17, dtime: "2020-01-03", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 18, dtime: "2020-01-04", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 19, dtime: "2020-01-05", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 20, dtime: "2020-01-06", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 21, dtime: "2020-01-07", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 22, dtime: "2020-01-08", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 23, dtime: "2020-01-09", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 24, dtime: "2020-01-10", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 25, dtime: "2020-01-11", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 26, dtime: "2020-01-12", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 27, dtime: "2020-01-13", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 28, dtime: "2020-01-14", temperature: 0, voltage: 0, SOC: "0%" },
    { num: 29, dtime: "2020-01-15", temperature: 0, voltage: 0, SOC: "0%" }
  ],
  errorCode: 0,
  errorMsg: ""
};

function formatChartData(data: any) {
  const { results = [], legend = [], unit = [] } = data;
  const yData = results.map(row =>
    row.map(item => {
      const value = Number(item.val);
      return isNaN(value) ? 0 : value;
    })
  );
  const xData = (results[0] || []).map(item => item.dtime);
  const series = legend.map((item, index) => ({
    name: item,
    unit: unit[index] || ""
  }));

  return {
    xData,
    yData,
    series
  };
}

export default formatChartData(res.results);
